#!/bin/sh
TEMP_DIR=$(mktemp -d)
INSTALL_DIR=/tmp/sjb/local

mkdir -p $INSTALL_DIR

export PKG_CONFIG_PATH=$INSTALL_DIR/lib/pkgconfig:/usr/share/pkgconfig
export CFLAGS=-I$INSTALL_DIR/include
export LDFLAGS=-L$INSTALL_DIR/lib
export PREFIX=$INSTALL_DIR
export PATH=$INSTALL_DIR/bin:$PATH
export PYTHONPATH=$INSTALL_DIR/lib/python3/dist-packages

# xcb-proto
cd $TEMP_DIR
wget 'https://xcb.freedesktop.org/dist/xcb-proto-1.14.tar.gz'
tar -xf xcb-proto-1.14.tar.gz
cd xcb-proto-1.14
./configure --prefix=$INSTALL_DIR
make && make install

# libxcb
cd $TEMP_DIR
wget 'https://xcb.freedesktop.org/dist/libxcb-1.14.tar.gz'
tar -xf libxcb-1.14.tar.gz
cd libxcb-1.14
./configure --prefix=$INSTALL_DIR
make && make install

# xcb-util-wm
cd $TEMP_DIR
wget 'https://xcb.freedesktop.org/dist/xcb-util-wm-0.4.1.tar.gz'
tar -xf xcb-util-wm-0.4.1.tar.gz
cd xcb-util-wm-0.4.1
./configure --prefix=$INSTALL_DIR
make && make install

# xcb-util
cd $TEMP_DIR
wget 'https://xcb.freedesktop.org/dist/xcb-util-0.4.0.tar.gz'
tar -xf xcb-util-0.4.0.tar.gz
cd xcb-util-0.4.0
./configure --prefix=$INSTALL_DIR
make && make install

# xcb-util-keysyms
cd $TEMP_DIR
wget 'https://xcb.freedesktop.org/dist/xcb-util-keysyms-0.4.0.tar.gz'
tar -xf xcb-util-keysyms-0.4.0.tar.gz
cd xcb-util-keysyms-0.4.0
./configure --prefix=$INSTALL_DIR
make && make install

# bspwm
cd $TEMP_DIR
git clone https://github.com/baskerville/bspwm
cd bspwm
make && make install

# sxhkd
cd $TEMP_DIR
git clone https://github.com/baskerville/sxhkd
cd sxhkd
make && make install

# cmake
cd $TEMP_DIR
wget 'https://github.com/Kitware/CMake/releases/download/v3.17.3/cmake-3.17.3-Linux-x86_64.tar.gz'
tar -xf cmake-3.17.3-Linux-x86_64.tar.gz --strip-components=1 -C $INSTALL_DIR

# cairo
cd $TEMP_DIR
wget 'https://www.cairographics.org/releases/cairo-1.16.0.tar.xz'
tar -xf cairo-1.16.0.tar.xz
cd cairo-1.16.0
./configure --prefix=$INSTALL_DIR
make
make install

# alsa
cd $TEMP_DIR
wget 'https://www.alsa-project.org/files/pub/lib/alsa-lib-1.2.2.tar.bz2'
tar -xf alsa-lib-1.2.2.tar.bz2
cd alsa-lib-1.2.2
./configure --prefix=$INSTALL_DIR
make
make install

# xcb-util-image
cd $TEMP_DIR
wget 'https://xcb.freedesktop.org/dist/xcb-util-image-0.4.0.tar.bz2'
tar -xf xcb-util-image-0.4.0.tar.bz2
cd xcb-util-image-0.4.0
./configure --prefix=$INSTALL_DIR
make
make install

# xcb-util-renderutil
cd $TEMP_DIR
wget 'https://xcb.freedesktop.org/dist/xcb-util-renderutil-0.3.9.tar.bz2'
tar -xf xcb-util-renderutil-0.3.9.tar.bz2
cd xcb-util-renderutil-0.3.9
./configure --prefix=$INSTALL_DIR
make
make install

# xcb-util-cursor
cd $TEMP_DIR
wget 'https://xcb.freedesktop.org/dist/xcb-util-cursor-0.1.3.tar.bz2'
tar -xf xcb-util-cursor-0.1.3.tar.bz2
cd xcb-util-cursor-0.1.3
./configure --prefix=$INSTALL_DIR
make
make install

# python3-xcbgen
cd $TEMP_DIR
wget 'http://ftp.kr.debian.org/debian/pool/main/x/xcb-proto/python3-xcbgen_1.14-2_all.deb'
mkdir python3-xcbgen
dpkg -x python3-xcbgen_1.14-2_all.deb python3-xcbgen
cd python3-xcbgen/usr
cp -rl * $INSTALL_DIR

# polybar
cd $TEMP_DIR
git clone https://github.com/polybar/polybar
cd polybar
./build.sh -a -I -A
cd build
DESTDIR=$TEMP_DIR make install
cp -rl $TEMP_DIR/usr/local/* $INSTALL_DIR

rm -rf $TEMP_DIR
